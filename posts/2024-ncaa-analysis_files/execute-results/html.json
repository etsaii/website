{
  "hash": "167a342cdb7810f7acd6f54f875ca7e2",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"Statistical Analysis of 2024 Women's College Basketball\"\nsubtitle: \" \"\ndate: \"5/22/2023\"\ncategories:\n  - sports\n  - data\n---\n\n\n\n::: {#create-dataframe .cell execution_count=3}\n``` {.python .cell-code code-fold=\"true\"}\n# Create dataframe for offensive and defensive team stats\nteam_stats = pd.merge(raw_stats, raw_opponent_stats, on=\"School\", how=\"inner\")\nteam_stats.columns = team_stats.columns.str.replace('_x', '')\n\nteam_stats = team_stats[['School', 'Overall_SRS', 'Overall_SOS', 'Overall_W', 'Overall_L',\n                         'Team_FG', 'Team_FGA', 'Team_3P', 'Team_3PA',  'Team_FTA', 'Team_ORB', 'Team_TRB', 'Team_TOV',\n                         'Opponent_FG', 'Opponent_FGA', 'Opponent_3P', 'Opponent_3PA',  'Opponent_FTA', 'Opponent_ORB', 'Opponent_TRB', 'Opponent_TOV']].copy()\n\n# Set datatype\nteam_stats = team_stats.astype({\n    'Overall_SRS': 'float',\n    'Overall_SOS': 'float',\n    'Overall_W': 'int',\n    'Overall_L': 'int'\n})\n\n# Cast all other columns to float\ncast_to_float = team_stats.columns[5:]\nteam_stats[cast_to_float] = team_stats[cast_to_float].astype(float)\n\nteam_stats.dtypes\n\n# Divide teams into SRS percentile\nbins = [0, 0.25, 0.5, 0.8, 1]\nlabels = ['Bottom 25%', '25th-50th %', '50th-80th %', 'Top 20%']\n\nteam_stats['Pct_Group'] = pd.qcut(team_stats['Overall_SRS'], q=bins, labels=labels)\n```\n:::\n\n\n## Statistical Analysis of 2024 Women's College Basketball\n\nUnlike Men's College Basketball, statistical analysis on the Women's game is relatively sparse. Since analysis for the Men's game is widely available and well documented, I've applied some of the most popular methodologies to basic team stats for the Women's game to better understand how strongly corralated the four factors are with the teams simple rating system, measure the offsive and defensive efficiency of each team, and visualize the strengths (and weaknesses) of each team. Let's dive in!\n\n## Four Factors of Basketball\n\nThe Four Factors designed by Dean Oliver in \"Basketball on Paper\" is considered the moneyball of Basketball to measure a team's success. While these stats can be found calculated in [Sports Reference's Advanced School Stats](https://www.sports-reference.com/cbb/seasons/women/2024-advanced-school-stats.html), we'll calculated them to see how they correlate with the teams simple rating system then use the four factors to measure the offensive and defensive efficiency of each team.\n\nThese four factors are:\n\n**Shooting the ball well measured by effective Field Goal % (eFG%)**\n\n::: {#fg-pct .cell execution_count=4}\n``` {.python .cell-code code-fold=\"true\"}\n# Calculate both offensive and defensive effective field goal percentage\nteam_stats['Calc_Off_eFG%'] = (team_stats['Team_FG'] + 0.5 * team_stats['Team_3P']) / team_stats['Team_FGA']\nteam_stats['Calc_Def_eFG%'] = (team_stats['Opponent_FG'] + 0.5 * team_stats['Opponent_3P']) / team_stats['Opponent_FGA']\n```\n:::\n\n\nThe effective field goal % captures the teams ability to shoot the ball. Because at the end of the game, the team with the most points wins. This is calculated as `Field Goals Made + 0.5 * 3-pointers Made) / Field Goals Attempted`. Unlike FG%, this calculation adds 50% more credit for 3-pointers made, since they are worth more points.\n\n** Avoiding turnovers - Turnover % **\n\n::: {#turnover .cell execution_count=5}\n``` {.python .cell-code code-fold=\"true\"}\n# Calculate Pace or Possessions\nteam_stats['Pace'] = team_stats['Team_FGA'] - team_stats['Team_ORB'] + team_stats['Team_TOV'] + (0.475 * team_stats['Team_FTA'] )\n\n# Calculate Turnover %\nteam_stats['Calc_Off_TOV%'] = team_stats['Team_TOV'] / team_stats['Pace']\nteam_stats['Calc_Def_TOV%'] = team_stats['Opponent_TOV'] / team_stats['Pace']\n```\n:::\n\n\nGiving the ball away too often is a surefire way to lose a game. What percentage of possessions end in a turnover? \n\n`Turnover % = Turnovers / Possessions`\n\n**Second changes to score: Offensive rebound % **\n\n::: {#rebound .cell execution_count=6}\n``` {.python .cell-code code-fold=\"true\"}\n# Create the defensive rebound column\nteam_stats['Team_DRB'] = team_stats['Team_TRB'] - team_stats['Team_ORB']\nteam_stats['Opponent_DRB'] = team_stats['Opponent_TRB'] - team_stats['Opponent_ORB']\n\n# Calculate offensive rebound %\nteam_stats['Calc_ORB%'] = team_stats['Team_ORB'] / (team_stats['Team_ORB'] + team_stats['Opponent_DRB'])\nteam_stats['Calc_Opp_ORB%'] = team_stats['Opponent_ORB'] / (team_stats['Opponent_ORB'] + team_stats['Team_DRB'])\n```\n:::\n\n\nOffensive rebounds are a second change at scoring. So of the total rebounds happening while a team is on offense, how many are the offensive team getting them.\n\n`Offensive Rebounding % = Offensive Rebounds / (Offensive Rebounds + Opponent’s Defensive Rebounds)`\n\n\n**Getting to the foul line: Free throw rate**\n\n::: {#ft-rate .cell execution_count=7}\n``` {.python .cell-code code-fold=\"true\"}\nteam_stats['Calc_Off_FTR'] = team_stats['Team_FTA'] / team_stats['Team_FGA']\nteam_stats['Calc_Def_FTR'] = team_stats['Opponent_FTA'] / team_stats['Opponent_FGA']\n```\n:::\n\n\nFree throws are yet another attempt to score. So getting fouled  \n`Free Throw Rate = Free Throws Attempts / Field Goal Attempts`\n\n#### Relationship of Four Factors with Overall SRS\nOnce each of these metrics has been calculated, let's evaulate the impact each metric has on the overall simple rating system of the team.\n\n::: {#d75d8e04 .cell .column-screen-inset-shaded execution_count=8}\n``` {.python .cell-code code-fold=\"true\"}\n# Set up the figure with four subplots\nfig, axes = plt.subplots(2, 2, figsize=(12, 10))  # 2x2 grid\n\noff_four_factors = team_stats[['School', 'Overall_SRS', 'Calc_Off_eFG%', 'Calc_ORB%', 'Calc_Off_TOV%', 'Calc_Off_FTR']]\n\n# List of offensive factors\noffensive_factors = ['Calc_Off_eFG%', 'Calc_ORB%', 'Calc_Off_TOV%', 'Calc_Off_FTR']\n\n# Loop through the factors and plot each one against 'Overall_SRS'\nfor ax, factor in zip(axes.flatten(), offensive_factors):\n    sns.regplot(\n        data=off_four_factors,\n        x=factor,\n        y='Overall_SRS',\n        ax=ax,\n        scatter_kws={'s': 10},\n        line_kws={'color': 'red', 'linewidth': 0.8}\n    )\n    ax.set_title(f'Relationship between {factor} and Overall_SRS')\n\nplt.suptitle('Impact of Offensive Four Factors on Overall SRS', y=1.02)\nplt.tight_layout()\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](2024-ncaa-analysis_files/figure-html/cell-9-output-1.png){width=1142 height=984}\n:::\n:::\n\n\n::: {#da3fb3ee .cell execution_count=9}\n``` {.python .cell-code code-fold=\"true\"}\n# Set up the figure with four subplots\nfig, axes = plt.subplots(2, 2, figsize=(12, 10))  # 2x2 grid\n\ndef_four_factors = team_stats[['School', 'Overall_SRS', 'Calc_Def_eFG%', 'Calc_Opp_ORB%', 'Calc_Def_TOV%', 'Calc_Def_FTR']]\n\n# List of defensive factors\ndefensive_factors = ['Calc_Def_eFG%', 'Calc_Opp_ORB%', 'Calc_Def_TOV%', 'Calc_Def_FTR']\n\n# Loop through the factors and plot each one against 'Overall_SRS'\nfor ax, factor in zip(axes.flatten(), defensive_factors):\n    sns.regplot(\n        data=def_four_factors,\n        x=factor,\n        y='Overall_SRS',\n        ax=ax,\n        scatter_kws={'s': 10},\n        line_kws={'color': 'red', 'linewidth': 0.8}\n    )\n    ax.set_title(f'Relationship between {factor} and Overall_SRS')\n\nplt.suptitle('Impact of Defensive Four Factors on Overall SRS', y=1.02)\nplt.tight_layout()\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](2024-ncaa-analysis_files/figure-html/cell-10-output-1.png){width=1140 height=984}\n:::\n:::\n\n\nIn all calculations, I use per game average since as a basketball fan, it allows me to reason about the data and catch mistakes easier. For example, if free throw attemps is 78, I'm able to recognize and issue witih my data. To increase accuracy calculations could be done on a per game basis before averaged out.\n\n\nSources:\nhttps://kenpom.com/blog/four-factors/\n\n## Offensive & Defensive Efficiency\nIn order for us to measure the offensive and defensive efficiency of each team, we'll first calculate these stats for each team, this is their offense. For defense, we'll calculate how well their opponents do in each of these stats when playing against them.\n\n::: {#34036588 .cell execution_count=10}\n``` {.python .cell-code}\nteam_stats['Calc_Off_Eff'] = 32.333 + 1.55 * team_stats['Calc_Off_eFG%'] * 100 \\\n                                    + 0.47 * team_stats['Calc_ORB%'] * 100 \\\n                                    - 1.55 * team_stats['Calc_Off_TOV%'] * 100 \\\n                                    + 0.19 * team_stats['Calc_Off_FTR'] * 100\n\nsorted_df = team_stats.sort_values(by='Calc_Off_Eff', ascending=False)\nsorted_df[['School', 'Overall_SRS', 'Calc_Off_Eff', 'Calc_Off_eFG%', 'Calc_ORB%', 'Calc_Off_TOV%', 'Calc_Off_FTR']].head(10)\n```\n\n::: {.cell-output .cell-output-display execution_count=34}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>School</th>\n      <th>Overall_SRS</th>\n      <th>Calc_Off_Eff</th>\n      <th>Calc_Off_eFG%</th>\n      <th>Calc_ORB%</th>\n      <th>Calc_Off_TOV%</th>\n      <th>Calc_Off_FTR</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>124</th>\n      <td>Iowa NCAA</td>\n      <td>37.05</td>\n      <td>115.024700</td>\n      <td>0.579465</td>\n      <td>0.312408</td>\n      <td>0.177928</td>\n      <td>0.303698</td>\n    </tr>\n    <tr>\n      <th>270</th>\n      <td>South Carolina NCAA</td>\n      <td>45.27</td>\n      <td>113.435192</td>\n      <td>0.541765</td>\n      <td>0.405128</td>\n      <td>0.175164</td>\n      <td>0.275686</td>\n    </tr>\n    <tr>\n      <th>102</th>\n      <td>Gonzaga NCAA</td>\n      <td>26.30</td>\n      <td>111.769560</td>\n      <td>0.557175</td>\n      <td>0.388557</td>\n      <td>0.192770</td>\n      <td>0.246925</td>\n    </tr>\n    <tr>\n      <th>174</th>\n      <td>Michigan State NCAA</td>\n      <td>26.69</td>\n      <td>111.204764</td>\n      <td>0.553755</td>\n      <td>0.262712</td>\n      <td>0.160003</td>\n      <td>0.289095</td>\n    </tr>\n    <tr>\n      <th>121</th>\n      <td>Indiana NCAA</td>\n      <td>29.50</td>\n      <td>110.880181</td>\n      <td>0.575790</td>\n      <td>0.257436</td>\n      <td>0.182287</td>\n      <td>0.287092</td>\n    </tr>\n    <tr>\n      <th>194</th>\n      <td>Nevada-Las Vegas NCAA</td>\n      <td>19.63</td>\n      <td>110.066279</td>\n      <td>0.523977</td>\n      <td>0.318841</td>\n      <td>0.147565</td>\n      <td>0.231782</td>\n    </tr>\n    <tr>\n      <th>302</th>\n      <td>Texas NCAA</td>\n      <td>36.47</td>\n      <td>109.837609</td>\n      <td>0.521739</td>\n      <td>0.419800</td>\n      <td>0.190606</td>\n      <td>0.339384</td>\n    </tr>\n    <tr>\n      <th>59</th>\n      <td>Connecticut NCAA</td>\n      <td>37.65</td>\n      <td>109.648191</td>\n      <td>0.554330</td>\n      <td>0.311306</td>\n      <td>0.180385</td>\n      <td>0.248543</td>\n    </tr>\n    <tr>\n      <th>105</th>\n      <td>Green Bay NCAA</td>\n      <td>14.22</td>\n      <td>108.897663</td>\n      <td>0.536096</td>\n      <td>0.296651</td>\n      <td>0.164052</td>\n      <td>0.260803</td>\n    </tr>\n    <tr>\n      <th>289</th>\n      <td>Stanford NCAA</td>\n      <td>33.90</td>\n      <td>107.932516</td>\n      <td>0.520687</td>\n      <td>0.386273</td>\n      <td>0.179534</td>\n      <td>0.240317</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {#6e925c14 .cell execution_count=11}\n``` {.python .cell-code}\nteam_stats['Calc_Def_Eff'] = 32.333 + 1.55 * team_stats['Calc_Def_eFG%'] * 100 \\\n                                    + 0.47 * team_stats['Calc_Opp_ORB%'] * 100 \\\n                                    - 1.55 * team_stats['Calc_Def_TOV%']* 100 \\\n                                    + 0.19 * team_stats['Calc_Def_FTR'] * 100\n\nsorted_df = team_stats.sort_values(by='Calc_Def_Eff', ascending=True)\nsorted_df[['School', 'Overall_SRS', 'Calc_Def_Eff', 'Calc_Def_eFG%', 'Calc_Opp_ORB%', 'Calc_Def_TOV%', 'Calc_Def_FTR']].head(10)\n```\n\n::: {.cell-output .cell-output-display execution_count=35}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>School</th>\n      <th>Overall_SRS</th>\n      <th>Calc_Def_Eff</th>\n      <th>Calc_Def_eFG%</th>\n      <th>Calc_Opp_ORB%</th>\n      <th>Calc_Def_TOV%</th>\n      <th>Calc_Def_FTR</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>202</th>\n      <td>Norfolk State NCAA</td>\n      <td>1.29</td>\n      <td>69.918558</td>\n      <td>0.417879</td>\n      <td>0.296595</td>\n      <td>0.305444</td>\n      <td>0.327273</td>\n    </tr>\n    <tr>\n      <th>345</th>\n      <td>West Virginia NCAA</td>\n      <td>27.52</td>\n      <td>72.701254</td>\n      <td>0.444087</td>\n      <td>0.321665</td>\n      <td>0.320728</td>\n      <td>0.322600</td>\n    </tr>\n    <tr>\n      <th>83</th>\n      <td>Fairfield NCAA</td>\n      <td>5.03</td>\n      <td>73.152050</td>\n      <td>0.407407</td>\n      <td>0.280582</td>\n      <td>0.268881</td>\n      <td>0.324217</td>\n    </tr>\n    <tr>\n      <th>270</th>\n      <td>South Carolina NCAA</td>\n      <td>45.27</td>\n      <td>73.995298</td>\n      <td>0.367242</td>\n      <td>0.280952</td>\n      <td>0.210197</td>\n      <td>0.216605</td>\n    </tr>\n    <tr>\n      <th>16</th>\n      <td>Auburn NCAA</td>\n      <td>19.91</td>\n      <td>74.435290</td>\n      <td>0.416424</td>\n      <td>0.303191</td>\n      <td>0.281138</td>\n      <td>0.362260</td>\n    </tr>\n    <tr>\n      <th>293</th>\n      <td>Stony Brook</td>\n      <td>8.96</td>\n      <td>74.558590</td>\n      <td>0.390671</td>\n      <td>0.278618</td>\n      <td>0.228701</td>\n      <td>0.211856</td>\n    </tr>\n    <tr>\n      <th>305</th>\n      <td>Texas A&amp;M-Corpus Christi NCAA</td>\n      <td>-2.34</td>\n      <td>74.704027</td>\n      <td>0.400053</td>\n      <td>0.303388</td>\n      <td>0.251206</td>\n      <td>0.265284</td>\n    </tr>\n    <tr>\n      <th>114</th>\n      <td>Howard</td>\n      <td>-7.69</td>\n      <td>75.147372</td>\n      <td>0.398896</td>\n      <td>0.321820</td>\n      <td>0.262852</td>\n      <td>0.347472</td>\n    </tr>\n    <tr>\n      <th>205</th>\n      <td>North Carolina A&amp;T</td>\n      <td>-0.95</td>\n      <td>75.214453</td>\n      <td>0.399694</td>\n      <td>0.300813</td>\n      <td>0.248231</td>\n      <td>0.277182</td>\n    </tr>\n    <tr>\n      <th>302</th>\n      <td>Texas NCAA</td>\n      <td>36.47</td>\n      <td>75.503534</td>\n      <td>0.433592</td>\n      <td>0.275223</td>\n      <td>0.272871</td>\n      <td>0.280175</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {#7a96f491 .cell .column-screen-inset execution_count=12}\n``` {.python .cell-code code-fold=\"true\"}\ntop_20 = team_stats[team_stats['Pct_Group'] == \"Top 20%\"]\ntop20_4f = top_20[['School', 'Overall_SRS', 'Pace',\n                   'Calc_Off_Eff', 'Calc_Off_eFG%', 'Calc_ORB%', 'Calc_Off_TOV%', 'Calc_Off_FTR',\n                   'Calc_Def_Eff', 'Calc_Def_eFG%', 'Calc_Opp_ORB%', 'Calc_Def_TOV%', 'Calc_Def_FTR']].copy()\n\n\nfig, ax = plt.subplots(figsize=(12,12))\n\n# Assign values\nlabels = top20_4f.School\nx = top20_4f.Calc_Off_Eff\ny = top20_4f.Calc_Def_Eff\n\n# Set mean\nax.axvline(x=x.mean(), linestyle='--', color='red')\nax.axhline(y=y.mean(), linestyle='--', color='red')\n\n# Plot data\nfor x0, y0, label in zip(x, y, labels):\n  plt.text(x0, y0, label, fontsize=8, ha='right', va='bottom')\n\nplt.scatter(x, y)\n\n# Add grid\nax.grid(zorder=0, alpha=0.4)\nax.set_axisbelow(True)\n\nax.set_xlim(85, 120)\nax.set_ylim(98, 70)\n\n# Add labels and text\nax.set_xlabel('Adjusted Offensive Efficiency')\nax.set_ylabel('Adjusted Defensive Efficiency')\n\nax.text(0.99, 0.01, 'Better Offense\\nWorst Defense',\n        verticalalignment='bottom', horizontalalignment='right',\n        transform=ax.transAxes,\n        color='green', fontsize=12)\n\nax.text(0.99, 0.99, 'Better Offense\\nBetter Defense',\n        verticalalignment='top', horizontalalignment='right',\n        transform=ax.transAxes,\n        color='green', fontsize=12)\n\nax.text(0.01, 0.99, 'Worst Offense\\nBetter Defense',\n        verticalalignment='top', horizontalalignment='left',\n        transform=ax.transAxes,\n        color='green', fontsize=12)\n\nax.text(0.01, 0.01, 'Worst Offense\\nWorst Defense',\n        verticalalignment='bottom', horizontalalignment='left',\n        transform=ax.transAxes,\n        color='green', fontsize=12)\n\nax.set_title('2024 Women\\'s NCAA Basketball Tiers')\n```\n\n::: {.cell-output .cell-output-display execution_count=36}\n```\nText(0.5, 1.0, \"2024 Women's NCAA Basketball Tiers\")\n```\n\netsaii\n:::\n\n::: {.cell-output .cell-output-display}\n![](2024-ncaa-analysis_files/figure-html/cell-13-output-2.png){width=969 height=967}\n:::\n:::\n\n\n### Relationship of Four Factors\n\nOnce we have all four factors calculated, both for offense and defense, we can see how each factor impacts their SRS rating.\n\n\n\nIn many of the analysis, we'll also compare Sports Reference's Simple Rating System (SRS) with the stats that we calculate. The Overall SRS, \"takes into account average point differential and strength of schedule\", where zero is average and a high positive number signals a strong team.\n\nData Sources:\nSports Reference: https://www.sports-reference.com/cbb/seasons/women/2024-ratings.html\nMassey Rating: https://masseyratings.com/cbw/ncaa-d1/ratings\nSokol’s LRMC ratings: https://www2.isye.gatech.edu/~jsokol/lrmcW/\nMoore’s ratings: https://sonnymoorepowerratings.com/w-basket.htm\n\n",
    "supporting": [
      "2024-ncaa-analysis_files/figure-html"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}